@implements IDisposable
@using MudBlazor

@inject NavigationManager NavigationManager

<MudNavMenu Dense="false">

     <!-- #Default  -->
    <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">Home</MudNavLink>
    <MudNavLink Href="/Dashboard" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard">Dashboard</MudNavLink>

    <!-- #Tickets  -->
    <MudNavGroup Title="Tickets" Icon="@Icons.Material.Filled.Inbox">
        <MudNavLink Href="/Tickets/AllTickets" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.NewReleases">All Tickets</MudNavLink>
        <MudNavLink Href="/Tickets/Unassigned" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.NewReleases">Unassigned</MudNavLink>
        <MudNavLink Href="/Tickets/MyTickets" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.SupervisedUserCircle">My Tickets</MudNavLink>
        <MudDivider />
        <MudNavGroup Title="Companies" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Business">
            <MudNavLink Href="/Tickets/Companies/1" Match="NavLinkMatch.Prefix" Icon="@Icons.Custom.Brands.GitHub">Company 1</MudNavLink>
            <MudNavLink Href="/Tickets/Companies/2" Match="NavLinkMatch.Prefix" Icon="@Icons.Custom.Brands.Google">Company 2</MudNavLink>
            <MudNavLink Href="/Tickets/Companies/3" Match="NavLinkMatch.Prefix" Icon="@Icons.Custom.Uncategorized.WaterMelon">Company 3</MudNavLink>
        </MudNavGroup>
        <MudNavGroup Title="Departments" Icon="@Icons.Material.Filled.Book">
            <MudNavLink Href="/Tickets/Departments/1" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Group">Department 1</MudNavLink>
            <MudNavLink Href="/Tickets/Departments/2" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Group">Department 2</MudNavLink>
            <MudNavLink Href="/Tickets/Departments/3" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Group">Department 3</MudNavLink>
        </MudNavGroup>
        <MudNavGroup Title="Major Incidents" Icon="@Icons.Material.Filled.CrisisAlert">
            <MudNavLink Href="/Tickets/Priority/1" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Error">P1: Critical</MudNavLink>
            <MudNavLink Href="/Tickets/Priority/2" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Warning">P2: Error</MudNavLink>
            <MudNavLink Href="/Tickets/Priority/3" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Info">P3: Info</MudNavLink>
        </MudNavGroup>
    </MudNavGroup>

    <!-- #Users  -->
    <MudNavGroup Title="Users" Icon="@Icons.Material.Filled.People">
        <MudNavGroup Title="Companies" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Business."></MudNavGroup>
    </MudNavGroup>


     <!-- #Tools  -->
    <MudNavLink Href="/Knowledge" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.MenuBook">Knowledge Base</MudNavLink>
    <MudNavLink Href="/Monitoring" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.MonitorHeart">Monitoring</MudNavLink>

     <!-- #Administration  -->
    <MudNavLink Href="/Administration" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.AdminPanelSettings">Administration</MudNavLink>
    <MudNavLink Href="/Settings" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Settings">Settings</MudNavLink>

    <!-- ##NavBar Layout
        # Home
        # Dashboards
        # Tickets
            -- All Tickets
            -- Companies
            -- Departments
            -- Priority Tickets
        # Users
            -- Companies
        # Knowledge Base
        # Monitoring
        # Administration
        # Settings
    -->
</MudNavMenu>


@code {

    [CascadingParameter(Name = "RightToLeft")] public bool RightToLeft { get; set; }
    private string? currentUrl;

    protected override void OnInitialized()
    {
        currentUrl = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        NavigationManager.LocationChanged += OnLocationChanged;
    }

    private void OnLocationChanged(object? sender, LocationChangedEventArgs e)
    {
        currentUrl = NavigationManager.ToBaseRelativePath(e.Location);
        StateHasChanged();
    }

    public void Dispose()
    {
        NavigationManager.LocationChanged -= OnLocationChanged;
    }
}

<style>    
    .settings-error {
        color: red;
    }
</style>